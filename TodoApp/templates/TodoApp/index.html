{% extends 'TodoApp/base.html' %}
{% load static %}
{% block title %}–ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞{% endblock %}
{% block head %}<link rel="stylesheet" href="{% static 'TodoApp/css/index.css' %}">{% endblock %}
{% block content %}
    <section>
        <div class="container big-green-button green-button">
            <a href="{% url 'add_task' %}">–î–æ–±–∞–≤–∏—Ç—å –∑–∞–¥–∞—á—É</a>
        </div>
    </section>
    <section class="main-section">
        {% if not user.is_authenticated %}
            <div class="warning-block">
                <p class="warning-text">–í—ã –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–ª–∏—Å—å. –ß—Ç–æ–±—ã –≤—ã –º–æ–≥–ª–∏ —Å–æ–∑–¥–∞–≤–∞—Ç—å –∑–∞–¥–∞—á–∏, –≤–∞–º –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞—Ç—å—Å—è.
                    –î–ª—è —ç—Ç–æ–≥–æ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å –Ω–∞ —Å–∞–π—Ç–µ, –ª–∏–±–æ –≤–æ–π–¥–∏—Ç–µ</p>
            </div>
        {% else %}
        <div class="filter-section green-button">
            <a href="?status=all" class="filter-btn">–í—Å–µ</a>
            <a href="?status=done" class="filter-btn">–†–µ—à—ë–Ω–Ω—ã–µ</a>
            <a href="?status=not_done" class="filter-btn">–ù–µ—Ä–µ—à—ë–Ω–Ω—ã–µ</a>
            <a href="?status=overdue" class="filter-btn">–ü—Ä–æ—Å—Ä–æ—á–µ–Ω–Ω—ã–µ</a>
        </div>

        {% for task in tasks %}
            <div href="#" class="task-item
            {% if task.priority == 1 %} task-high
            {% elif task.priority == 2 %} task-medium
            {% else %} task-low
            {% endif %}">
                <h2>{{ task.title }}</h2>
                <p>{{ task.description|truncatechars:100 }}</p>
                <p>–î–µ–¥–ª–∞–π–Ω: {{ task.deadline }}</p>
                <p>–ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å: {{ task.is_done }}</p>
                <div class="task-actions">
                    <form method="post" action="{% url 'task_toggle' task.slug %}">
                        {% csrf_token %}
                        <button type="submit">
                            {% if task.is_done %}‚Ü© –ù–µ –≥–æ—Ç–æ–≤–æ{% else %}‚úî –ì–æ—Ç–æ–≤–æ{% endif %}
                        </button>
                    </form>

                    <a href="{{ task.get_absolute_url }}" class="btn-details">
                        üìÑ –ü–æ–¥—Ä–æ–±–Ω–µ–µ
                    </a>

                    <form method="post" action="{% url 'task_delete' task.slug %}">
                        {% csrf_token %}
                        <button type="submit">‚úñ –£–¥–∞–ª–∏—Ç—å</button>
                    </form>
                </div>
            </div>
        {% endfor %}
        {% endif %}
        {% if is_paginated %}
    <div class="pagination">
        <span class="step-links">
            {% if page_obj.has_previous %}
                <a href="?page=1&status={{ request.GET.status|default:'all' }}">&laquo; –ü–µ—Ä–≤–∞—è</a>
                <a href="?page={{ page_obj.previous_page_number }}&status={{ request.GET.status|default:'all' }}">–ü—Ä–µ–¥—ã–¥—É—â–∞—è</a>
            {% endif %}

            <span class="current">
                –°—Ç—Ä–∞–Ω–∏—Ü–∞ {{ page_obj.number }} –∏–∑ {{ paginator.num_pages }}.
            </span>

            {% if page_obj.has_next %}
                <a href="?page={{ page_obj.next_page_number }}&status={{ request.GET.status|default:'all' }}">–°–ª–µ–¥—É—é—â–∞—è</a>
                <a href="?page={{ paginator.num_pages }}&status={{ request.GET.status|default:'all' }}">–ü–æ—Å–ª–µ–¥–Ω—è—è &raquo;</a>
            {% endif %}
        </span>
    </div>
{% endif %}

    </section>
{% endblock %}